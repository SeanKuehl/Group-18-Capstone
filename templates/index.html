{% block page_title %}
    <h2>Posts</h2>
{% endblock page_title %}

<form action="{% url 'search_results'%}" method="get">
    <input name="q" type="text" placeholder="Search...">
</form>

{% block page_content %}
    {% block posts %}
        <h3>New Post:</h3>
        <form method="post">
            {% csrf_token %}
            <div>
                {{ form.post_title }}
            </div>
            <div>
                {{ form.post_community }}
            </div>
            <div>
                {{ form.post_body }}
            </div>
            <button type="submit" class="btn btn-primary">Submit</button>
        </form>
        {% for post in posts %}
            <h3><a href="{% url 'post_detail' post.pk %}">{{ post.post_title }}</a></h3>
            <small>
                {{ post.created_on.date }} | 
                {% if post.accountname %}
                    <a href="{% url 'user_account' post.accountname.pk %}">
                        {{ post.accountname.account_name }}
                    </a>
                {% else %}
                    <!-- Link to superuser account page -->
                    <a href="{% url 'user_account' '0' %}">Superuser</a>
                {% endif %}
                | Tags:
                {% for tag in post.tags.all %}
                    <a href="{% url 'post_tag' tag.name %}">
                        {{ tag.name }}
                    </a>
                {% endfor %}
            </small>
            <p>{{ post.post_body | slice:":400" }}...</p>
        {% endfor %}
    {% endblock posts %}
{% endblock page_content %}
